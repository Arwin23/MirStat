# MirStat
**Simple tool to analyze miRNA QPCR data**

## Motivation
MirStat is an R script developed to analyze miRNA data obtained by QPCR arrays. It generates a principal component analyze for the first 3 dimensions and a heatmap for each predefined groups.
Developed for the study: *Teichenne et al, Identification of miRNAs Involved in Reprogramming Acinar Cells into Insulin Producing Cells, 2015*

## Principle
MirStat.R is a simple R script which analyzes QPCR values from a CSV file (see example in /data).
Users can modify the existing groups in the first part of the code so it can match their own sample names. 

**For each group**: For each qPCR, 1 sample with an NA or all samples with undetermined values will trigger its exclusion from the group analysis. The remaining qPCR data are reduced, centered and classified by hierarchical cluster analysis. A principal component analyze is performed with FactoMineR package and summarized by graphs and tables in both individual and variable spaces. Finally, a distance matrix is generated by the Pearson method and subsequently used to create a heatmap scaled by individual sample thanks to gplots package.

## Get MirStat
### From github repository 
``` bash
git clone https://github.com/a-slide/MirStat
sudo chmod u+x MirStat.R
```
You may also add the executable to your system PATH

## Usage

First, the R script code had to be edited with your own sample name to create as many group as needed. Just add a new vector line as shown below

```R
# Create a list of group names to analyze data separately
v1 = c("sample1-1", "sample1-2", "sample1-3", "sample2-1", "sample2-2", "sample2-3")
v2 = c("sample2-1", "sample2-2", "sample2-3", "sample3-1", "sample3-2", "sample3-3")
```

Update the group list and group name vector to match your group names

```R
# Define group list and group names
group.list = list(v1,v2)
names(group.list) = c("sample1 vs sample2", "sample2 vs sample3")
```

Format your **tab separated csv** data sheet as follow:
```  
            qPCR1   qPCR2   qPCR3   ...
sample1-1   0.23    0       12334   ...
sample1-2   12      0       8755    ...
sample1-3   65      0       87545   ...
...         ...     ...     ...     ...
```

See example file in the data folder

Run the script with the data sheet path as only argument
``` bash
Usage: MirStat.R my ./path/myQPCRresult.csv
```

All file will be generated in the current folder

## Dependencies:
The program was developed under Linux Mint 16 "petra" but is compatible with other LINUX debian based distributions.
Not tested under windows or Mac

#### Program
* R

#### Third party R packages
* FactoMineR
* RColorBrewer
* gplots

## Authors and Contact
Adrien Leger - 2015
* <adrien.leger@gmail.com>  <adrien.leger@inserm.fr>  <adrien.leger@univ-nantes.fr>
* [Github](https://github.com/a-slide)
* [Atlantic Gene Therapies - INSERM 1089](http://www.atlantic-gene-therapies.fr/)
* [Drowned in genomics Blog](http://a-slide.github.io/)
